<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理后台</title>
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
    <div class="admin-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>管理后台</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="#profile" class="nav-item active" data-section="profile">个人信息</a>
                <a href="#files" class="nav-item" data-section="files">文件管理</a>
                <a href="#theme" class="nav-item" data-section="theme">主题设置</a>
                <a href="#layout" class="nav-item" data-section="layout">布局管理</a>
                <a href="#stats" class="nav-item" data-section="stats">访问统计</a>
                <a href="#settings" class="nav-item" data-section="settings">设置</a>
            </nav>
            <div class="sidebar-footer">
                <a href="/" class="btn-view-site">查看网站</a>
                <button id="logoutBtn" class="btn-logout">退出登录</button>
            </div>
        </aside>

        <main class="main-content">
            <!-- Profile Section -->
            <section id="profile-section" class="content-section active">
                <h2>个人信息</h2>
                <form id="profileForm">
                    <div class="form-group">
                        <label for="name">姓名</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="title">职位/头衔</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="bio">个人简介</label>
                        <textarea id="bio" name="bio" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="email">邮箱</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="github">GitHub链接</label>
                        <input type="url" id="github" name="github" required>
                    </div>
                    <div class="form-group">
                        <label for="location">所在地</label>
                        <input type="text" id="location" name="location" required>
                    </div>
<div class="form-group">
                        <label for="avatar">头像URL</label>
                        <input type="text" id="avatar" name="avatar" required>
                        <div class="upload-area">
                            <input type="file" id="avatarFile" accept="image/*">
                            <label for="avatarFile" class="upload-btn">上传头像</label>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 2rem; margin-bottom: 1rem;">公告栏设置</h3>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="announcementEnabled" name="announcementEnabled">
                            启用公告栏
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="announcementText">公告内容</label>
                        <textarea id="announcementText" name="announcementText" rows="2" placeholder="输入公告内容"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="announcementType">公告类型</label>
                        <select id="announcementType" name="announcementType">
                            <option value="info">信息</option>
                            <option value="warning">警告</option>
                            <option value="success">成功</option>
                            <option value="error">错误</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">保存</button>
                </form>
                
                <h3 style="margin-top: 3rem; margin-bottom: 1rem;">Hero按钮管理</h3>
                <div class="buttons-management">
                    <div class="buttons-header">
                        <h4>按钮列表</h4>
                        <button id="addButtonBtn" class="btn btn-primary">添加按钮</button>
                    </div>
                    <div id="buttonsList" class="buttons-list"></div>
                    <button id="saveButtonsBtn" class="btn btn-secondary" style="margin-top: 1rem;">保存按钮配置</button>
                </div>
            </section>

            <!-- Skills Section -->
            <section id="skills-section" class="content-section">
                <h2>技能管理</h2>
                <div id="skillsList"></div>
                <button id="addSkillBtn" class="btn btn-secondary">添加技能</button>
                <button id="saveSkillsBtn" class="btn btn-primary">保存技能</button>
            </section>

            <!-- Files Section -->
            <section id="files-section" class="content-section">
                <h2>文件管理</h2>
                <div id="filesStatusWarning" class="alert-warning" style="display: none;">
                    <strong>⚠️ 警告：</strong> 有 <span id="missingFilesCount">0</span> 个文件在重新部署后丢失，请重新上传。
                </div>
                <div class="file-upload-section">
                    <h3>上传新文件</h3>
                    <form id="fileUploadForm">
                        <div class="form-group">
                            <label for="fileInput">选择文件（支持批量上传）</label>
                            <input type="file" id="fileInput" multiple required>
                        </div>
                        <div class="form-group">
                            <label for="fileFolder">文件夹（可选）</label>
                            <input type="text" id="fileFolder" placeholder="例如：documents, images, projects">
                            <p class="help-text">输入文件夹名称以将文件组织到不同目录中</p>
                        </div>
                        <div class="form-group">
                            <label for="fileDescription">文件描述</label>
                            <input type="text" id="fileDescription" placeholder="输入文件描述（批量上传时所有文件使用相同描述）">
                        </div>
                        <button type="submit" class="btn btn-primary">上传文件</button>
                    </form>
                </div>
                <div class="files-list-section">
                    <h3>已上传文件</h3>
                    <div id="filesList" class="admin-files-list"></div>
                </div>
            </section>

            <!-- Theme Section -->
            <section id="theme-section" class="content-section">
                <h2>主题设置</h2>
                <form id="themeForm">
                    <div class="form-group">
                        <label for="backgroundType">背景类型</label>
                        <select id="backgroundType" name="background_type">
                            <option value="gradient">渐变色</option>
                            <option value="image">图片</option>
                            <option value="solid">纯色</option>
                        </select>
                    </div>
                    <div class="form-group" id="gradientOptions">
                        <label>渐变颜色</label>
                        <div class="color-picker-group">
                            <div>
                                <label>起始颜色</label>
                                <input type="color" id="backgroundColor" name="background_color" value="#667eea">
                            </div>
                            <div>
                                <label>结束颜色</label>
                                <input type="color" id="backgroundColorEnd" name="background_color_end" value="#764ba2">
                            </div>
                        </div>
                    </div>
                    <div class="form-group" id="imageOptions" style="display: none;">
                        <label for="backgroundImage">背景图片URL</label>
                        <input type="text" id="backgroundImage" name="background_image" placeholder="输入图片URL">
                        <div class="upload-area">
                            <input type="file" id="backgroundImageFile" accept="image/*">
                            <label for="backgroundImageFile" class="upload-btn">上传背景图</label>
                        </div>
                    </div>
                    <div class="form-group" id="solidOptions" style="display: none;">
                        <label for="solidBackgroundColor">背景颜色</label>
                        <input type="color" id="solidBackgroundColor" name="solid_background_color" value="#667eea">
                    </div>
                    <div class="form-group">
                        <label for="cursorStyle">鼠标样式</label>
                        <select id="cursorStyle" name="cursor_style">
                            <option value="default">默认</option>
                            <option value="pointer">指针</option>
                            <option value="custom">自定义</option>
                        </select>
                    </div>
                    <div class="form-group" id="cursorUploadGroup" style="display: none;">
                        <label for="cursorFile">自定义鼠标文件</label>
                        <input type="file" id="cursorFile" accept=".cur,.png,.svg,.ico">
                        <button type="button" id="uploadCursorBtn" class="btn btn-secondary">上传鼠标文件</button>
                        <p class="help-text">支持格式：.cur, .png, .svg, .ico</p>
                    </div>
                    <button type="submit" class="btn btn-primary">保存主题</button>
                </form>
            </section>

            <!-- Admin Theme Section -->
            <section id="admin-theme-section" class="content-section">
                <h2>后台界面主题</h2>
                <form id="adminThemeForm">
                    <h3>背景设置</h3>
                    <div class="form-group">
                        <label>背景类型</label>
                        <select id="adminBackgroundType">
                            <option value="gradient">渐变</option>
                            <option value="image">图片</option>
                            <option value="solid">纯色</option>
                        </select>
                    </div>
                    <div class="form-group" id="adminGradientOptions">
                        <label>渐变颜色</label>
                        <div class="color-picker-group">
                            <div>
                                <label>起始颜色</label>
                                <input type="color" id="adminBackgroundColor" value="#1f2937">
                            </div>
                            <div>
                                <label>结束颜色</label>
                                <input type="color" id="adminBackgroundColorEnd" value="#374151">
                            </div>
                        </div>
                    </div>
                    <div class="form-group" id="adminImageOptions" style="display: none;">
                        <label>背景图片URL</label>
                        <input type="text" id="adminBackgroundImage" placeholder="输入图片URL">
                    </div>
                    <div class="form-group" id="adminSolidOptions" style="display: none;">
                        <label>背景颜色</label>
                        <input type="color" id="adminSolidBackgroundColor" value="#1f2937">
                    </div>

                    <h3>界面配色</h3>
                    <div class="form-group">
                        <label for="adminPrimaryColor">主色调</label>
                        <input type="color" id="adminPrimaryColor" name="primary_color" value="#6366f1">
                    </div>
                    <div class="form-group">
                        <label for="adminSidebarBg">侧边栏背景色</label>
                        <input type="color" id="adminSidebarBg" name="sidebar_bg" value="#1f2937">
                    </div>
                    <div class="form-group">
                        <label for="adminSidebarText">侧边栏文字颜色</label>
                        <input type="color" id="adminSidebarText" name="sidebar_text" value="#ffffff">
                    </div>
                    <div class="form-group">
                        <label for="adminContentBg">内容区背景色</label>
                        <input type="color" id="adminContentBg" name="content_bg" value="#f9fafb">
                    </div>
                    <div class="form-group">
                        <label for="adminCardBg">卡片背景色</label>
                        <input type="color" id="adminCardBg" name="card_bg" value="#ffffff">
                    </div>

                    <button type="submit" class="btn btn-primary">保存后台主题</button>
                </form>
            </section>

            <!-- Layout Section -->
            <section id="layout-section" class="content-section">
                <h2>布局管理</h2>
                <p class="section-description">管理页面模块的显示、添加和删除</p>
                
                <div class="layout-management">
                    <div class="layout-header">
                        <h3>模块列表</h3>
                        <button id="addModuleBtn" class="btn btn-primary">添加模块</button>
                    </div>
                    <div id="layoutModules" class="layout-modules"></div>
                </div>

                <div class="projects-skills-section">
                    <h3>项目管理</h3>
                    <button id="addProjectBtn" class="btn btn-secondary">添加项目</button>
                    <div id="projectsList" class="projects-list"></div>
                </div>

                <div class="projects-skills-section">
                    <h3>技能管理</h3>
                    <button id="addSkillBtn" class="btn btn-secondary">添加技能</button>
                    <div id="skillsList" class="skills-list"></div>
                </div>

                <button id="saveLayoutBtn" class="btn btn-primary">保存所有更改</button>
            </section>

            <!-- Stats Section -->
            <section id="stats-section" class="content-section">
                <h2>访问统计</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>总访问量</h3>
                        <p id="totalVisits" class="stat-number">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>最后访问时间</h3>
                        <p id="lastVisit" class="stat-text">-</p>
                    </div>
                </div>

                <h3 style="margin-top: 2rem;">访问者记录</h3>
                <div class="visitor-logs">
                    <table class="visitor-table">
                        <thead>
                            <tr>
                                <th>IP地址</th>
                                <th>访问时间</th>
                                <th>用户代理</th>
                            </tr>
                        </thead>
                        <tbody id="visitorLogs">
                            <!-- 访问记录将在这里动态加载 -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings-section" class="content-section">
                <h2>设置</h2>
                <form id="passwordForm">
                    <div class="form-group">
                        <label for="oldPassword">旧密码</label>
                        <input type="password" id="oldPassword" name="oldPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">新密码</label>
                        <input type="password" id="newPassword" name="newPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">确认新密码</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required minlength="6">
                    </div>
                    <button type="submit" class="btn btn-primary">修改密码</button>
                </form>
            </section>
        </main>
    </div>

    <!-- Project Modal -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">添加项目</h2>
            <form id="projectForm">
                <input type="hidden" id="projectId">
                <div class="form-group">
                    <label for="projectTitle">项目名称</label>
                    <input type="text" id="projectTitle" name="title" required>
                </div>
                <div class="form-group">
                    <label for="projectDescription">项目描述</label>
                    <textarea id="projectDescription" name="description" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="projectImage">图片URL</label>
                    <input type="text" id="projectImage" name="image">
                    <div class="upload-area">
                        <input type="file" id="projectImageFile" accept="image/*">
                        <label for="projectImageFile" class="upload-btn">上传图片</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="projectLink">项目链接</label>
                    <input type="url" id="projectLink" name="link" required>
                </div>
                <div class="form-group">
                    <label for="projectTags">标签（用逗号分隔）</label>
                    <input type="text" id="projectTags" name="tags" placeholder="Web, 前端, JavaScript">
                </div>
                <button type="submit" class="btn btn-primary">保存</button>
            </form>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="/static/js/admin.js?v=8"></script>
</body>
</html>